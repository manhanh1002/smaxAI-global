I have gathered all the necessary information to implement the automated system prompt generation.

### Analysis of Current State
1.  **Onboarding Flow**:
    *   **Step 1 (Business Info)**: Collects Name, Type, Description.
    *   **Step 2 (Training Data)**: Collects Products, Services, Slots, FAQs.
    *   **Step 3 (Go Live)**: Currently just a 3-second simulation.

2.  **System Prompt Reference ("Aura Zen Wellness Retreat")**:
    *   The prompt is highly structured, including:
        *   **Persona**: "Aura Zen" or "Em/MÃ¬nh", professional yet soothing tone.
        *   **Principles**: Listen first, personalize, be professional (no slang).
        *   **Constraints**: No medical advice, stick to the menu, polite error handling.
        *   **Sales Workflow**: Needs Analysis -> Presentation (Benefit -> Service -> Price) -> Closing.
        *   **Formatting**: Mobile-friendly, bullet points, bold text.
        *   **Simulation Examples**: Sample Q&A.

3.  **Implementation Plan**
    I will modify the onboarding flow to generate a similar high-quality prompt for *any* merchant using AI.

    *   **Backend Changes (Edge Function)**:
        *   Create a new Edge Function `generate-system-prompt` (or reuse a utility function) that takes the merchant's `business_type`, `name`, `description`, `services`, `products`, and `faqs` as input.
        *   This function will call the AI (using the existing `Token.ai.vn` config) to generate a personalized system prompt following the "Aura Zen" structure.

    *   **Frontend Changes (`StepGoLive.tsx`)**:
        *   Modify `StepGoLive` to actually call this new generation function instead of just sleeping for 3 seconds.
        *   Display a "Generating your AI persona..." state.
        *   Save the generated prompt to the `ai_configs` table.

### Proposed AI Prompt Template (for the Generator)
I will construct a meta-prompt that tells the AI:
"You are an expert AI Prompt Engineer. Create a system prompt for a chatbot representing a [Business Type] named '[Name]'.
Context: [Description].
Products: [List]. Services: [List].
Structure the prompt with these sections: Personality, Service Principles, Constraints, Sales Workflow, Formatting Rules.
Use the tone appropriate for [Business Type] (e.g., soothing for Spa, energetic for Gym)."

### Execution Steps
1.  **Create `generate_system_prompt` RPC or Edge Function**: To handle the AI generation securely.
2.  **Update `StepGoLive.tsx`**: To trigger this generation and save the result.
3.  **Verify**: Run through the onboarding wizard and check if a detailed system prompt is created in `ai_configs`.
